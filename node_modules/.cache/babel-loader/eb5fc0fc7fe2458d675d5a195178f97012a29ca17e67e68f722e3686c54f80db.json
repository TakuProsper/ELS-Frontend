{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useParams}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookingDetails=()=>{const{id}=useParams();// Get booking ID from URL parameters\nconst[booking,setBooking]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[cancelled,setCancelled]=useState(false);const[cancelLoading,setCancelLoading]=useState(false);// State for cancel loading\nuseEffect(()=>{// Fetch booking details by ID\naxios.get(`http://localhost:8000/api/bookings/${id}/`).then(response=>{setBooking(response.data);setLoading(false);}).catch(error=>{console.error(error);setError('Failed to fetch booking details');setLoading(false);});},[id]);const handleCancel=async()=>{// Retrieve the token from localStorage\nconst token=localStorage.getItem(\"authTokens\");if(!token){setError(\"You must be logged in to cancel a booking.\");return;}const accessToken=JSON.parse(token).access;setCancelLoading(true);// Set cancel loading to true when submitting\ntry{const response=await axios.delete(`http://localhost:8000/api/cancel-booking/${id}/`,{headers:{'Authorization':`Bearer ${accessToken}`,// Pass the token here\n'Content-Type':'application/json'}});setCancelled(true);}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||\"An error occurred.\");}finally{setCancelLoading(false);// Set cancel loading to false when done\n}};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading booking details...\"});if(error)return/*#__PURE__*/_jsx(\"p\",{children:error});return/*#__PURE__*/_jsx(\"div\",{className:\"BookingDetails\",children:/*#__PURE__*/_jsx(\"section\",{className:\"vh-150\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container py-5 h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex justify-content-center align-items-center h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col col-xl-10 d-flex justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{borderRadius:\"1rem\",width:'100%',maxWidth:'600px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"row g-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12 col-lg-12 d-flex align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-4 p-lg-5 text-black\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-100\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Booking Details\"}),booking?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Event name:\"}),\" \",booking.event_name]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Description:\"})}),/*#__PURE__*/_jsx(\"p\",{children:booking.event_description}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",new Date(booking.event_date).toLocaleDateString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ticket Quantity:\"}),\" \",booking.ticket_quantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Cost:\"}),\" $\",booking.total_cost]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Location:\"}),\" \",booking.event_location]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Time:\"}),\" \",booking.event_time]}),!cancelled&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn button\",type:\"button\",onClick:handleCancel,disabled:cancelLoading// Disable the button when cancel is loading\n,children:[cancelLoading?\"Processing...\":\"Cancel Booking\",\" \"]}),cancelled&&/*#__PURE__*/_jsx(\"p\",{children:\"Booking cancelled!\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No booking details found.\"})]})})})})})})})})})});};export default BookingDetails;","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","jsx","_jsx","jsxs","_jsxs","BookingDetails","id","booking","setBooking","loading","setLoading","error","setError","cancelled","setCancelled","cancelLoading","setCancelLoading","get","then","response","data","catch","console","handleCancel","token","localStorage","getItem","accessToken","JSON","parse","access","delete","headers","_error$response","_error$response$data","children","className","style","borderRadius","width","maxWidth","event_name","event_description","Date","event_date","toLocaleDateString","ticket_quantity","total_cost","event_location","event_time","type","onClick","disabled"],"sources":["/home/taku_prosper/Documents/GitHub/ELS-Frontend/src/components/BookingDetails.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\nconst BookingDetails = () => {\n  const { id } = useParams(); // Get booking ID from URL parameters\n  const [booking, setBooking] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [cancelled, setCancelled] = useState(false);\n  const [cancelLoading, setCancelLoading] = useState(false); // State for cancel loading\n\n  useEffect(() => {\n    // Fetch booking details by ID\n    axios.get(`http://localhost:8000/api/bookings/${id}/`)\n      .then(response => {\n        setBooking(response.data);\n        setLoading(false);\n      })\n      .catch(error => {\n        console.error(error);\n        setError('Failed to fetch booking details');\n        setLoading(false);\n      });\n  }, [id]);\n\n  const handleCancel = async () => {\n    // Retrieve the token from localStorage\n    const token = localStorage.getItem(\"authTokens\");\n    if (!token) {\n      setError(\"You must be logged in to cancel a booking.\");\n      return;\n    }\n\n    const accessToken = JSON.parse(token).access;\n\n    setCancelLoading(true); // Set cancel loading to true when submitting\n\n    try {\n      const response = await axios.delete(\n        `http://localhost:8000/api/cancel-booking/${id}/`,\n        {\n          headers: {\n            'Authorization': `Bearer ${accessToken}`,  // Pass the token here\n            'Content-Type': 'application/json',\n          }\n        }\n      );\n\n      setCancelled(true);\n    } catch (error) {\n      setError(error.response?.data?.error || \"An error occurred.\");\n    } finally {\n      setCancelLoading(false); // Set cancel loading to false when done\n    }\n  };\n\n  if (loading) return <p>Loading booking details...</p>;\n  if (error) return <p>{error}</p>;\n\n  return (\n    <div className='BookingDetails'>\n      <section className=\"vh-150\">\n        <div className=\"container py-5 h-100\">\n          <div className=\"row d-flex justify-content-center align-items-center h-100\">\n            <div className=\"col col-xl-10 d-flex justify-content-center align-items-center\">\n              <div className=\"card\" style={{ borderRadius: \"1rem\", width: '100%', maxWidth: '600px' }}>\n                <div className=\"row g-0\">\n                  <div className=\"col-md-12 col-lg-12 d-flex align-items-center\">\n                    <div className=\"card-body p-4 p-lg-5 text-black\">\n                      <div className='w-100'> \n                        <h2>Booking Details</h2>\n                        {booking ? (\n                          <div>\n                            <p><strong>Event name:</strong> {booking.event_name}</p>\n                            <p><strong>Description:</strong></p><p>{booking.event_description}</p>\n                            <p><strong>Date:</strong> {new Date(booking.event_date).toLocaleDateString()}</p>\n                            <p><strong>Ticket Quantity:</strong> {booking.ticket_quantity}</p>\n                            <p><strong>Total Cost:</strong> ${booking.total_cost}</p>\n                            <p><strong>Location:</strong> {booking.event_location}</p>\n                            <p><strong>Time:</strong> {booking.event_time}</p>\n                            {/* You can add more booking details here */}\n                            {!cancelled && (\n                              <button \n                                className='btn button' \n                                type=\"button\" \n                                onClick={handleCancel} \n                                disabled={cancelLoading} // Disable the button when cancel is loading\n                              >\n                                {cancelLoading ? \"Processing...\" : \"Cancel Booking\"} {/* Change button text based on loading state */}\n                              </button>\n                            )}\n                            {cancelled && (\n                              <p>Booking cancelled!</p>\n                            )}\n                          </div>\n                        ) : (\n                          <p>No booking details found.</p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n};\n\nexport default BookingDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}